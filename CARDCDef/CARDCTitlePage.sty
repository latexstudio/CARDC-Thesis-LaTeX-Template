\ProvidesPackage{CARDCTitlePage}

\RequirePackage{setspace}   %行距
\RequirePackage{xstring}    %字符串比较
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%中英文封面、独创性声明页
%--------------------------------------------------------------------
\renewcommand{\maketitle}{%
    \CARDC@CNTitlePage
    \CARDC@ENTitlePage
    \CARDC@declarePage
}
%====================================================================

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%中文扉页
%--------------------------------------------------------------------
\newcommand{\CARDC@ArtBigTitle}{}         %文章大标题
\newcommand{\CARDC@ArtSubmitDate}{}       %文章的提交日期

\newcommand{\CARDC@FirstTutorName}{}      %导师名字
\newcommand{\CARDC@FirstTutorPost}{}      %导师职称
\newcommand{\CARDC@WithTwoTutor}{Y}       %是否有副导师
\newcommand{\CARDC@SecondTutorName}{}     %副导师名字
\newcommand{\CARDC@SecondTutorPost}{}     %副导师职称

\newcommand{\CARDC@StudentName}{}         %学生名字
\newcommand{\CARDC@StudentMajor}{}        %专业
\newcommand{\CARDC@ResearchDirection}{}   %研究方向
\newcommand{\CARDC@SecretLevel}{}         %密级
\newcommand{\CARDC@StudentID}{}           %学号

%中文扉页
\newcommand{\CARDC@CNTitlePage}{%

\thispagestyle{empty}   %无页眉页脚

\includegraphics[width=81pt]{pic/CARDC/cardc.png}%
\hspace{0.5em}
{\heiti\sanhao \CARDC@MasterOrDoctor 士学位论文}%
\hfill
\raisebox{60pt}{
\begin{tabular}{|c|c|}
  \hline
  {\heiti\xiaosi 单位代码}      &   {\bfseries\xiaosi{90113}}           \\ \hline
  {\heiti\xiaosi 密\hfill 级}   &   {\heiti\xiaosi\CARDC@SecretLevel}   \\ \hline
  {\heiti\xiaosi 学\hfill 号}   &   {\heiti\xiaosi\CARDC@StudentID}     \\ \hline
\end{tabular}
}

\vskip45pt

\begin{center}
\begin{spacing}{3.2}
{\textbf{\heiti \yihao \CARDC@ArtBigTitle}}
\end{spacing}
\end{center}

\vskip100pt

\begin{center}
{\heiti \sanhao
\begin{tabular}{cl}
    \CARDC@MasterOrDoctor\hfill 士\hfill 生：   &
        \hspace{0.5em}\CARDC@StudentName                                       \\
    导\hfill 师：            &
        \hspace{0.5em}\CARDC@FirstTutorName\hspace{1em}\CARDC@FirstTutorPost   \\
    \IfStrEq{\CARDC@WithTwoTutor}{Y}{%
    副\hfill 导\hfill 师：   &
        \hspace{0.5em}\CARDC@SecondTutorName\hspace{1em}\CARDC@SecondTutorPost \\
    }{\relax}%
    学科专业：               & \hspace{0.5em}\CARDC@StudentMajor               \\
    研究方向：               & \hspace{0.5em}\CARDC@ResearchDirection          \\
\end{tabular}}
\end{center}

\vfill

\begin{center}
{\heiti \sanhao 中国空气动力研究与发展中心研究生部}
\end{center}


\begin{center}
{\heiti \sanhao \CARDC@ArtSubmitDate }
\end{center}

\newpage
\thispagestyle{empty}
\cleardoublepage
}
%====================================================================


%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%英文扉页
%--------------------------------------------------------------------
\newcommand{\CARDC@ArtBigTitleEN}{}         %文章大标题英文英文
\newcommand{\CARDC@ArtSubmitDateEN}{}       %文章的提交日期

\newcommand{\CARDC@FirstTutorNameEN}{}      %导师名字英文
\newcommand{\CARDC@SecondTutorNameEN}{}     %副导师名字英文

\newcommand{\CARDC@StudentNameEN}{}         %学生名字英文

%英文扉页
\newcommand{\CARDC@ENTitlePage}{%

\thispagestyle{empty}

\includegraphics[width=81pt]{pic/CARDC/cardc.png}%

\vspace{-12pt}

\begin{center}
\begin{spacing}{2.5}
{\fontspec{Times New Roman} \erhao \bfseries \CARDC@ArtBigTitleEN}
\end{spacing}
\end{center}

\begin{center}
{\fontspec{Times New Roman} \sanhao \bfseries By}
\end{center}

\vspace{15pt}

\begin{center}
{\fontspec{Times New Roman} \erhao \bfseries \CARDC@StudentNameEN}
\end{center}

\vspace{10pt}

\begin{center}
{\fontspec{Times New Roman} \xiaosan \bfseries
    \IfStrEq{\CARDC@MasterOrDoctor}{硕}{A Thesis }{A Dissertation }%
    Submitted to the Graduate Faculty of\\%
    China Aerodynamics Research and Development Center\\%
    for the Degree of%
    \IfStrEq{\CARDC@MasterOrDoctor}{硕}{ Master }{ Doctor }%
    in Fluid Mechanics

}
\end{center}

\vspace{15pt}

\begin{center}
{\fontspec{Times New Roman} \xiaosan \bfseries Academic Advisors}
\end{center}

\begin{center}
{\fontspec{Times New Roman} \xiaosan \bfseries
 \CARDC@FirstTutorNameEN \\ \CARDC@SecondTutorNameEN }
\end{center}

\vfill

\begin{center}
{\fontspec{Times New Roman}\sanhao
\bfseries{China Aerodynamics Research and Development Center Graduate School}}
\end{center}


\begin{center}
{\fontspec{Times New Roman} \bfseries \heiti \sanhao \CARDC@ArtSubmitDateEN }
\end{center}

\newpage
\thispagestyle{empty}
\cleardoublepage
}
%====================================================================


%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%独创性声明页
%   本页考虑了填空栏目对齐，以及超长标题的紧缩性排版，保持美观
%--------------------------------------------------------------------
\newcommand{\CARDC@declare}{%纯文本，无\par等命令
本人声明所呈交的学位论文是我本人在导师指导下进行的%
研究工作及取得的研究成果，论文中有关资料和数据是实事求是的。%
尽我所知，除文中已经加以标注和致谢的地方外，论文中不包含%
其他人已经发表和撰写过的研究成果，也不包含为获得%
中国空气动力研究与发展中心或其它教育机构的学位或证书%
而使用过的材料。与我一同工作的研究者对本研究所做的任%
何贡献均已在论文中作了明确的说明。
}

\newcommand{\CARDC@authorization}{%纯文本，无\par等命令
本人完全了解中国空气动力研究与发展中心有关保留、使用学位论文的规定。%
本人授权中国空气动力研究与发展中心可以保留并向国家有关部门或%
机构送交论文的复印件和电子文档，允许论文被查阅和借阅；可以将%
学位论文的全部或部分内容编入有关数据库进行检索，可以采用影印、%
缩印或扫描等复制手段保存、汇编学位论文。%
}

\newcommand{\CARDC@secretText}{
保密学位论文在解密后适用本授权书。%
}

%声明页
\newcommand{\CARDC@declarePage}{%

\thispagestyle{empty}

{\fangsong%该页全部使用仿宋字体

\begin{center}
    {\xiaoer{独\hspace{1em}创\hspace{1em}性\hspace{1em}声\hspace{1em}明}}
\end{center}
\vspace{0pt minus 24pt}

%对齐栏目
\newlength{\CARDC@declarePageAuthorText}
\settowidth{\CARDC@declarePageAuthorText}{{学位论文作者签名}}

\newlength{\CARDC@declarePageTitleLeft}
\settowidth{\CARDC@declarePageTitleLeft}{{：}}
\addtolength{\CARDC@declarePageTitleLeft}{\CARDC@declarePageAuthorText}

\newlength{\CARDC@declarePageTitleRight}
\setlength{\CARDC@declarePageTitleRight}{\textwidth}
\addtolength{\CARDC@declarePageTitleRight}{-2.2\ccwd}
\addtolength{\CARDC@declarePageTitleRight}{-\CARDC@declarePageTitleLeft}

%论文标题的宽度
\newlength{\CARDC@ArtTileWidth}
\settowidth{\CARDC@ArtTileWidth}{\CARDC@ArtTitle}

%学位论文题目一栏
\newcommand{\CARDC@declarePageArtTile}{%
    \makebox[\CARDC@declarePageAuthorText][s]{学位论文题目}：%
    \ifdim\CARDC@ArtTileWidth<\CARDC@declarePageTitleRight
        \underline{\makebox[\CARDC@declarePageTitleRight]{\CARDC@ArtTitle}}
    \else
        \raisebox{-13pt}{
            \begin{minipage}{\CARDC@declarePageTitleRight}
                \uline{\CARDC@ArtTitle}
            \end{minipage}
        }
    \fi
}

%学位作者签名一栏
\newcommand{\CARDC@declarePageAuthor}{%
    {学位论文作者签名：}
    \underline{\makebox{\hspace{9em}}}\hfill
    {日期：}
    \underline{\makebox{\hspace{4em}年\hspace{2em}月\hspace{2em}日}}
}

\par
\begin{spacing}{2.0}
    {\xiaosi\CARDC@declare}

    \par{\CARDC@declarePageArtTile}

    \par{\CARDC@declarePageAuthor}
\end{spacing}

\vfill

\begin{center}
    {\xiaoer{学位论文版权使用授权书}}
\end{center}
\vspace{0pt minus 24pt}

\par
\begin{spacing}{2}
    {\xiaosi\CARDC@authorization}
    \par
    {\xiaosi\CARDC@secretText}

    \par
    {
        {$\square$}公开\hspace{2em}
        {$\square$}保密
        \underline{\makebox{（密级：\hspace{6em}保密年限：\hspace{3em}年）}}
    }

    \par{\CARDC@declarePageArtTile}

    \par{\CARDC@declarePageAuthor}

    \par
    {
        \makebox[\CARDC@declarePageAuthorText][s]{指导教师签名}%
         ：\underline{\makebox{\hspace{9em}}}\hfill
        {日期：}
        \underline{\makebox{\hspace{4em}年\hspace{2em}月\hspace{2em}日}}
    }

\end{spacing}

}

\newpage
\thispagestyle{empty}
\cleardoublepage
}
%====================================================================

\endinput
